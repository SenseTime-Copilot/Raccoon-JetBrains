<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.sensetime.sensecore.sensecodeplugin</id>
    <name>SenseCode</name>
    <vendor>SenseTime</vendor>

    <depends>com.intellij.modules.platform</depends>
    <resource-bundle>i18n.messages</resource-bundle>

    <applicationListeners>
        <listener class="com.sensetime.sensecore.sensecodeplugin.clients.CodeClientManager$CredentialsListener"
                  topic="com.sensetime.sensecore.sensecodeplugin.messages.SenseCodeCredentialsListener"/>
    </applicationListeners>

    <extensions defaultExtensionNs="com.intellij">
        <!--        UI-->
        <notificationGroup displayType="BALLOON" id="com.sensetime.sensecore.sensecodeplugin.balloon"/>

        <toolWindow id="SenseCode" anchor="right"
                    factoryClass="com.sensetime.sensecore.sensecodeplugin.toolwindows.SenseCodeToolWindowFactory"
                    icon="com.sensetime.sensecore.sensecodeplugin.resources.SenseCodeIcons.TOOLWINDOW_SENSECODE">
        </toolWindow>

        <statusBarWidgetFactory id="SenseCode" order="last"
                                implementation="com.sensetime.sensecore.sensecodeplugin.statusbar.SenseCodeStatusBarWidgetFactory"/>

        <applicationConfigurable
                instance="com.sensetime.sensecore.sensecodeplugin.settings.SenseCodeConfigurable"
                id="com.sensetime.sensecore.sensecodeplugin.settings.SenseCodeConfigurable"
                displayName="SenseCode"/>


        <!--        Persistent Data-->
        <applicationService
                serviceImplementation="com.sensetime.sensecore.sensecodeplugin.settings.SenseCodeSettingsState"/>
        <applicationService
                serviceImplementation="com.sensetime.sensecore.sensecodeplugin.toolwindows.SenseCodeChatHistoryState"/>


        <!--        Local Http Server-->
        <httpRequestHandler
                implementation="com.sensetime.sensecore.sensecodeplugin.services.http.authentication.SenseNovaAuthService"/>


        <!--        Inline Completion-->
        <backgroundPostStartupActivity
                implementation="com.sensetime.sensecore.sensecodeplugin.completions.auto.AutoCompletionServer$Initializer"/>
        <editorFactoryDocumentListener
                implementation="com.sensetime.sensecore.sensecodeplugin.completions.auto.EditorChangeDetector"/>
        <editorFactoryMouseListener
                implementation="com.sensetime.sensecore.sensecodeplugin.completions.auto.EditorChangeDetector"/>
        <typedHandler implementation="com.sensetime.sensecore.sensecodeplugin.completions.auto.UserTypedHandler"/>

        <actionPromoter implementation="com.sensetime.sensecore.sensecodeplugin.actions.inline.InlineActionsPromoter"/>
        <editorActionHandler action="EditorEscape" order="before hide-hints"
                             id="com.sensetime.sensecore.sensecodeplugin.actions.inline.EscapeEditorActionHandler"
                             implementationClass="com.sensetime.sensecore.sensecodeplugin.actions.inline.EscapeEditorActionHandler"/>
    </extensions>

    <actions>
        <!--        Code Task-->
        <group id="com.sensetime.sensecore.sensecodeplugin.actions.CodeTaskGroup" text="SenseCode" popup="true">
            <!--            Add actions to the tools menu-->
            <add-to-group
                    group-id="ToolsMenu"
                    anchor="last">
            </add-to-group>
            <!--            Right-click in the editor-->
            <add-to-group
                    group-id="EditorPopupMenu"
                    anchor="last">
            </add-to-group>

            <action id="com.sensetime.sensecore.sensecodeplugin.actions.task.GenerationAction"
                    class="com.sensetime.sensecore.sensecodeplugin.actions.task.GenerationAction">
                <keyboard-shortcut first-keystroke="control alt shift G" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift G" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift G" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.sensecore.sensecodeplugin.actions.task.AddTestAction"
                    class="com.sensetime.sensecore.sensecodeplugin.actions.task.AddTestAction">
                <keyboard-shortcut first-keystroke="control alt shift U" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift U" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift U" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.sensecore.sensecodeplugin.actions.task.CodeConversionAction"
                    class="com.sensetime.sensecore.sensecodeplugin.actions.task.CodeConversionAction">
                <keyboard-shortcut first-keystroke="control alt shift X" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift X" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift X" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.sensecore.sensecodeplugin.actions.task.CodeCorrectionAction"
                    class="com.sensetime.sensecore.sensecodeplugin.actions.task.CodeCorrectionAction">
                <keyboard-shortcut first-keystroke="control alt shift F" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift F" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift F" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.sensecore.sensecodeplugin.actions.task.RefactoringAction"
                    class="com.sensetime.sensecore.sensecodeplugin.actions.task.RefactoringAction">
                <keyboard-shortcut first-keystroke="control alt shift R" keymap="$default"/>
                <keyboard-shortcut first-keystroke="control alt shift R" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift R" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
        </group>


        <!--        Inline Completion-->
        <action id="com.sensetime.sensecore.sensecodeplugin.actions.inline.ManualTriggerInlineCompletionAction"
                class="com.sensetime.sensecore.sensecodeplugin.actions.inline.ManualTriggerInlineCompletionAction">
            <keyboard-shortcut first-keystroke="control alt SLASH" keymap="$default"/>
            <keyboard-shortcut first-keystroke="control alt SLASH" keymap="Mac OS X" replace-all="true"/>
            <keyboard-shortcut first-keystroke="control alt SLASH" keymap="Mac OS X 10.5+" replace-all="true"/>
        </action>
        <action id="com.sensetime.sensecore.sensecodeplugin.actions.inline.ShowPreviousInlineCompletionAction"
                class="com.sensetime.sensecore.sensecodeplugin.actions.inline.ShowPreviousInlineCompletionAction">
            <keyboard-shortcut first-keystroke="alt OPEN_BRACKET" keymap="$default"/>
        </action>
        <action id="com.sensetime.sensecore.sensecodeplugin.actions.inline.ShowNextInlineCompletionAction"
                class="com.sensetime.sensecore.sensecodeplugin.actions.inline.ShowNextInlineCompletionAction">
            <keyboard-shortcut first-keystroke="alt CLOSE_BRACKET" keymap="$default"/>
        </action>
        <action id="com.sensetime.sensecore.sensecodeplugin.actions.inline.AcceptInlineCompletionAction"
                class="com.sensetime.sensecore.sensecodeplugin.actions.inline.AcceptInlineCompletionAction"
                text="Accept Inline Completion">
            <keyboard-shortcut first-keystroke="TAB" keymap="$default"/>
        </action>
    </actions>
</idea-plugin>

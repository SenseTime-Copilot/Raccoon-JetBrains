<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.sensetime.intellij.plugins.sensecode</id>
    <name>SenseCode</name>
    <vendor>SenseTime</vendor>

    <depends>com.intellij.modules.platform</depends>
    <resource-bundle>i18n.messages</resource-bundle>

    <applicationListeners>
        <listener class="com.sensetime.intellij.plugins.sensecode.clients.SenseCodeClientManager$CredentialsListener"
                  topic="com.sensetime.intellij.plugins.sensecode.topics.SenseCodeCredentialsListener"/>
    </applicationListeners>

    <extensions defaultExtensionNs="com.intellij">
        <!--        Persistent Data-->
        <applicationService
                serviceImplementation="com.sensetime.intellij.plugins.sensecode.persistent.settings.SenseCodeSettingsState"/>
        <applicationService
                serviceImplementation="com.sensetime.intellij.plugins.sensecode.persistent.histories.SenseCodeChatHistoriesState"/>

        <!--        UI-->
        <notificationGroup displayType="BALLOON" id="SenseCode Notification Group"/>

        <toolWindow id="SenseCode" anchor="right"
                    factoryClass="com.sensetime.intellij.plugins.sensecode.ui.toolwindows.SenseCodeToolWindowFactory"
                    icon="com.sensetime.intellij.plugins.sensecode.resources.SenseCodeIcons.TOOLWINDOW_SENSECODE">
        </toolWindow>

        <statusBarWidgetFactory id="SenseCode" order="last"
                                implementation="com.sensetime.intellij.plugins.sensecode.ui.SenseCodeStatusBarWidgetFactory"/>

        <applicationConfigurable
                instance="com.sensetime.intellij.plugins.sensecode.ui.SenseCodeConfigurable"
                id="com.sensetime.intellij.plugins.sensecode.ui.SenseCodeConfigurable"
                displayName="SenseCode"/>

        <!--        Local Http Server-->
        <httpRequestHandler
                implementation="com.sensetime.intellij.plugins.sensecode.services.authentication.SenseChatAuthService"/>
















        <!--        Inline Completion-->
        <backgroundPostStartupActivity
                implementation="com.sensetime.intellij.plugins.sensecode.completions.auto.AutoCompletionServer$Initializer"/>
        <editorFactoryDocumentListener
                implementation="com.sensetime.intellij.plugins.sensecode.completions.auto.EditorChangeDetector"/>
        <editorFactoryMouseListener
                implementation="com.sensetime.intellij.plugins.sensecode.completions.auto.EditorChangeDetector"/>
        <typedHandler implementation="com.sensetime.intellij.plugins.sensecode.completions.auto.UserTypedHandler"/>

        <actionPromoter implementation="com.sensetime.intellij.plugins.sensecode.actions.inline.InlineActionsPromoter"/>
        <editorActionHandler action="EditorEscape" order="before hide-hints"
                             id="com.sensetime.intellij.plugins.sensecode.actions.inline.EscapeEditorActionHandler"
                             implementationClass="com.sensetime.intellij.plugins.sensecode.actions.inline.EscapeEditorActionHandler"/>
    </extensions>



    <actions>
        <!--        Code Task-->
        <group id="com.sensetime.intellij.plugins.sensecode.tasks.CodeTaskActionsGroup" text="SenseCode" popup="true">
            <!--            Add actions to the tools menu-->
            <add-to-group
                    group-id="ToolsMenu"
                    anchor="last">
            </add-to-group>
            <!--            Right-click in the editor-->
            <add-to-group
                    group-id="EditorPopupMenu"
                    anchor="last">
            </add-to-group>

            <action id="com.sensetime.intellij.plugins.sensecode.tasks.Generation"
                    class="com.sensetime.intellij.plugins.sensecode.tasks.Generation">
                <keyboard-shortcut first-keystroke="control alt shift G" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift G" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift G" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.intellij.plugins.sensecode.tasks.AddTest"
                    class="com.sensetime.intellij.plugins.sensecode.tasks.AddTest">
                <keyboard-shortcut first-keystroke="control alt shift U" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift U" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift U" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.intellij.plugins.sensecode.tasks.CodeConversion"
                    class="com.sensetime.intellij.plugins.sensecode.tasks.CodeConversion">
                <keyboard-shortcut first-keystroke="control alt shift X" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift X" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift X" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.intellij.plugins.sensecode.tasks.CodeCorrection"
                    class="com.sensetime.intellij.plugins.sensecode.tasks.CodeCorrection">
                <keyboard-shortcut first-keystroke="control alt shift F" keymap="$default" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift F" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift F" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
            <action id="com.sensetime.intellij.plugins.sensecode.tasks.Refactoring"
                    class="com.sensetime.intellij.plugins.sensecode.tasks.Refactoring">
                <keyboard-shortcut first-keystroke="control alt shift R" keymap="$default"/>
                <keyboard-shortcut first-keystroke="control alt shift R" keymap="Mac OS X" replace-all="true"/>
                <keyboard-shortcut first-keystroke="control alt shift R" keymap="Mac OS X 10.5+" replace-all="true"/>
            </action>
        </group>









        <!--        Inline Completion-->
        <action id="com.sensetime.intellij.plugins.sensecode.actions.inline.ManualTriggerInlineCompletionAction"
                class="com.sensetime.intellij.plugins.sensecode.actions.inline.ManualTriggerInlineCompletionAction">
            <keyboard-shortcut first-keystroke="control alt SLASH" keymap="$default"/>
            <keyboard-shortcut first-keystroke="control alt SLASH" keymap="Mac OS X" replace-all="true"/>
            <keyboard-shortcut first-keystroke="control alt SLASH" keymap="Mac OS X 10.5+" replace-all="true"/>
        </action>
        <action id="com.sensetime.intellij.plugins.sensecode.actions.inline.ShowPreviousInlineCompletionAction"
                class="com.sensetime.intellij.plugins.sensecode.actions.inline.ShowPreviousInlineCompletionAction">
            <keyboard-shortcut first-keystroke="alt OPEN_BRACKET" keymap="$default"/>
        </action>
        <action id="com.sensetime.intellij.plugins.sensecode.actions.inline.ShowNextInlineCompletionAction"
                class="com.sensetime.intellij.plugins.sensecode.actions.inline.ShowNextInlineCompletionAction">
            <keyboard-shortcut first-keystroke="alt CLOSE_BRACKET" keymap="$default"/>
        </action>
        <action id="com.sensetime.intellij.plugins.sensecode.actions.inline.AcceptInlineCompletionAction"
                class="com.sensetime.intellij.plugins.sensecode.actions.inline.AcceptInlineCompletionAction"
                text="Accept Inline Completion">
            <keyboard-shortcut first-keystroke="TAB" keymap="$default"/>
        </action>
    </actions>
</idea-plugin>
